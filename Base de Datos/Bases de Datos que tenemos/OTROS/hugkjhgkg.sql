DROP DATABASE IF EXISTS fp_comunidad_madrid;
CREATE DATABASE IF NOT EXISTS fp_comunidad_madrid;
USE fp_comunidad_madrid;

CREATE TABLE FAMILIAPROFESIONAL (
COD_FAMILIA VARCHAR(4),
DESCRIPCION VARCHAR(40),
REAL_DECRETO VARCHAR(25),
CONSTRAINT FAMILIA_PK PRIMARY KEY (COD_FAMILIA)
)ENGINE = INNODB;

CREATE TABLE CICLOSFP (
COD_CICLO VARCHAR(4),
DENOMINACION VARCHAR(20),
REF_EUROPEO VARCHAR(20), 
DURACION INT, 
COD_FAMILIA VARCHAR(4),
CONSTRAINT CICLOSFP_PK PRIMARY KEY (COD_CICLO),
CONSTRAINT familia_FK FOREIGN KEY (COD_FAMILIA) REFERENCES FAMILIAPROFESIONAL(COD_FAMILIA)
)ENGINE = INNODB; 

CREATE TABLE IES (
COD_IES VARCHAR(4),
NOMBRE VARCHAR(20),
LOCALIDAD VARCHAR(20), 
CONSTRAINT IES_PK PRIMARY KEY (COD_IES)
)ENGINE = INNODB;

CREATE TABLE MODULOS (
COD_MODULO VARCHAR(4), 
CREDITOS TINYINT, 
DESCRIPCION VARCHAR(20),
H_SEMANALES TINYINT,
H_TOTALES INT,
CONSTRAINT MODULOS_PK PRIMARY KEY (COD_MODULO) 
)ENGINE = INNODB;

CREATE TABLE CICLOSFPIES (
COD_CICLO VARCHAR(4),
COD_IES VARCHAR(4),
TURNO VARCHAR(1),
F_IMPLANTACION DATE,
CONSTRAINT CICLOSFPIES_PK PRIMARY KEY (COD_CICLO, COD_IES),
CONSTRAINT CICLOS_FK FOREIGN KEY (COD_CICLO) REFERENCES CICLOSFP(cod_ciclo),
CONSTRAINT INSTITUTO_FK FOREIGN KEY (COD_IES) REFERENCES IES (COD_IES)
)ENGINE = INNODB;

CREATE TABLE CICLOSFPMODULOS (
COD_CICLO VARCHAR(4),
COD_MODULO VARCHAR(4), 
CONSTRAINT CICLOSMODULOS_PK PRIMARY KEY (COD_CICLO, COD_MODULO), 
CONSTRAINT CICLOSMOD_FK FOREIGN KEY (COD_CICLO) REFERENCES CICLOSFP(cod_ciclo),
CONSTRAINT CICLOSMODU_FK FOREIGN KEY (COD_MODULO) REFERENCES MODULOS(COD_MODULO)
)ENGINE = INNODB;

CREATE TABLE EMPRESAFCT (
CIF VARCHAR(20),
NOMBRE VARCHAR(20),
SEDE VARCHAR(20),
NACIONAL_INTERNACIONAL VARCHAR(20),
N_TRABAJADOR int,
CMMI ENUM ('1','2','3','4','5'), 
tipo VARCHAR(3),
CONSTRAINT EMPRESAFCT_PK PRIMARY KEY (CIF),
CONSTRAINT check_CMMI CHECK(CMMI IN('1','2','3','4','5')
))ENGINE = INNODB;

CREATE TABLE FCTASIR (
CIF VARCHAR(20),
tecnologias varchar(20),
CONSTRAINT FCTASIR_PK PRIMARY KEY (CIF),
CONSTRAINT FCTASIR_FK FOREIGN KEY (CIF) REFERENCES EMPRESAFCT (cif)
)ENGINE = INNODB;

CREATE TABLE FCTDAW (
CIF VARCHAR(20),
CONSTRAINT FCTDAW_PK PRIMARY KEY (CIF),
CONSTRAINT FCTDAW_FK FOREIGN KEY (CIF) REFERENCES EMPRESAFCT(cif)
)ENGINE = INNODB;

insert into FAMILIAPROFESIONAL values ('0001','informática','www.boe.es');
insert into FAMILIAPROFESIONAL values ('0002','sanitaria','www.boe.es');
insert into FAMILIAPROFESIONAL values ('0003','imagen y sonido','www.boe.es');
insert into FAMILIAPROFESIONAL values ('0004','mecánica','www.boe.es');
insert into FAMILIAPROFESIONAL values ('0005','jardineria','www.boe.es');


insert into CICLOSFP values ('0001','ASIR','CN200',2000 ,'0001');
insert into CICLOSFP values ('0002','DAW','CN201',3000,'0001');
insert into CICLOSFP values ('0003','Paisajismo','CN201',2000,'0005');
insert into CICLOSFP values ('0004','FARMACIA','CN204',1000,'0002');
insert into CICLOSFP values ('0005','LABORATORIOS_clin','CN206',2000,'0002');
insert into CICLOSFP values ('0006','ANIMACION 3D','CN206',2020,'0003');
insert into CICLOSFP values ('0007','Disc-Jockey y Sonido','CN216',2020,'0003');


insert into IES values ('0001','IES_LAARBOLEA','Alcorcón');
insert into IES values ('0002','josefina_aldecoa','Alcorcón');
insert into IES values ('0003','los_castillos','Alcorcón');
insert into IES values ('0004','Antonio Gala','Mostoles');
insert into IES values ('0005','la_inmaculada','Mostles');


insert into MODULOS values ('0001',100,'sistemas',8,300);
insert into MODULOS values ('0002',4,'sgi',4,140);
insert into MODULOS values ('0003',6,'redes',6,200);
insert into MODULOS values ('0004',6,'DBD',6,100);
insert into MODULOS values ('0005',6,'servicios',6,180);
insert into MODULOS values ('0006',4,'entornos',3,100);
insert into MODULOS values ('0007',4,'programacion',8,700);
insert into MODULOS values ('0008',3,'FOL',3,100);

insert into CICLOSFPIES values ('0001','0001','m','2017-01-01');
insert into CICLOSFPIES values ('0002','0001','m','2017-02-02');
insert into CICLOSFPIES values ('0005','0001','m','2017-03-03');
insert into CICLOSFPIES values ('0006','0001','t','2017-04-04');
insert into CICLOSFPIES values ('0002','0002','t','2017-05-05');
insert into CICLOSFPIES values ('0002','0003','t','2017-04-04');
insert into CICLOSFPIES values ('0003','0002','t','2017-05-05');
insert into CICLOSFPIES values ('0007','0001','t','2017-05-05');


insert into CICLOSFPMODULOS values ('0001','0001');
insert into CICLOSFPMODULOS values ('0001','0002');
insert into CICLOSFPMODULOS values ('0001','0003');
insert into CICLOSFPMODULOS values ('0001','0004');
insert into CICLOSFPMODULOS values ('0001','0008');
insert into CICLOSFPMODULOS values ('0003','0004');
insert into CICLOSFPMODULOS values ('0002','0008');


insert into EMPRESAFCT values ('0001','Accenture','Madrid','inter',300,1,'DAW');
insert into EMPRESAFCT values ('0002','Indra','Madrid','Nacional',300,1,'DAM');
insert into EMPRESAFCT values ('0003','everist','Madrid','internacional',300,1,'DAW');


insert into FCTASIR values ('0001', 'DevOps');

insert into FCTDAW values ('0003');


/*** MAL MIRAR**/

/*ALTER TABLE EMPRESAFCT  MODIFY (NACIONAL_INTERNACIONAL VARCHAR(29));
ALTER TABLE EMPRESAFCT  MODIFY (NACIONAL_INTERNACIONAL VARCHAR(29));*/
